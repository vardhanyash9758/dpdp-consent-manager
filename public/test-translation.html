<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translation System Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .language-buttons {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .language-btn {
            padding: 10px 15px;
            border: 1px solid #007bff;
            background: white;
            color: #007bff;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .language-btn:hover {
            background: #007bff;
            color: white;
        }
        .language-btn.active {
            background: #007bff;
            color: white;
        }
        .translation-result {
            margin: 15px 0;
            padding: 15px;
            background: #e8f5e8;
            border-left: 4px solid #28a745;
            border-radius: 4px;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .error {
            background: #f8d7da;
            border-left-color: #dc3545;
            color: #721c24;
        }
        .original-text {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .translated-text {
            font-size: 18px;
            color: #155724;
        }
        .test-texts {
            display: grid;
            gap: 15px;
        }
        .text-item {
            padding: 10px;
            background: white;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üåê Translation System Test</h1>
        <p>Test the real-time translation functionality for the DPDP Consent Management System.</p>
        
        <div class="test-section">
            <h2>Language Selection</h2>
            <p>Click on a language to test translations:</p>
            <div class="language-buttons" id="languageButtons">
                <button class="language-btn active" data-lang="en" data-name="English">English</button>
                <button class="language-btn" data-lang="bh" data-name="Bhojpuri - ‡§≠‡•ã‡§ú‡§™‡•Å‡§∞‡•Ä">Bhojpuri - ‡§≠‡•ã‡§ú‡§™‡•Å‡§∞‡•Ä</button>
                <button class="language-btn" data-lang="mr" data-name="Marathi - ‡§Æ‡§∞‡§æ‡§†‡•Ä">Marathi - ‡§Æ‡§∞‡§æ‡§†‡•Ä</button>
                <button class="language-btn" data-lang="ta" data-name="Tamil - ‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç">Tamil - ‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
                <button class="language-btn" data-lang="gu" data-name="Gujarati - ‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä">Gujarati - ‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä</button>
                <button class="language-btn" data-lang="kn" data-name="Kannada - ‡≤ï‡≤®‡≥ç‡≤®‡≤°">Kannada - ‡≤ï‡≤®‡≥ç‡≤®‡≤°</button>
            </div>
        </div>

        <div class="test-section">
            <h2>Translation Results</h2>
            <div class="test-texts" id="testTexts">
                <div class="text-item">
                    <div class="original-text">Request for Data Usage Consent</div>
                    <div class="translation-result" id="result-1">
                        <div class="translated-text">Request for Data Usage Consent</div>
                    </div>
                </div>
                
                <div class="text-item">
                    <div class="original-text">Your data privacy is important to us. You have the right to decline any optional data collection or usage not required for the basic functioning of our services.</div>
                    <div class="translation-result" id="result-2">
                        <div class="translated-text">Your data privacy is important to us. You have the right to decline any optional data collection or usage not required for the basic functioning of our services.</div>
                    </div>
                </div>
                
                <div class="text-item">
                    <div class="original-text">Marketing</div>
                    <div class="translation-result" id="result-3">
                        <div class="translated-text">Marketing</div>
                    </div>
                </div>
                
                <div class="text-item">
                    <div class="original-text">Analytics</div>
                    <div class="translation-result" id="result-4">
                        <div class="translated-text">Analytics</div>
                    </div>
                </div>
                
                <div class="text-item">
                    <div class="original-text">Accept All</div>
                    <div class="translation-result" id="result-5">
                        <div class="translated-text">Accept All</div>
                    </div>
                </div>
                
                <div class="text-item">
                    <div class="original-text">Reject All</div>
                    <div class="translation-result" id="result-6">
                        <div class="translated-text">Reject All</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>Test Status</h2>
            <div id="testStatus">Ready to test translations</div>
        </div>
    </div>

    <script>
        const testTexts = [
            'Request for Data Usage Consent',
            'Your data privacy is important to us. You have the right to decline any optional data collection or usage not required for the basic functioning of our services.',
            'Marketing',
            'Analytics',
            'Accept All',
            'Reject All'
        ];

        let currentLanguage = 'en';
        let isTranslating = false;

        // Initialize language buttons
        document.getElementById('languageButtons').addEventListener('click', (e) => {
            if (e.target.classList.contains('language-btn')) {
                // Update active button
                document.querySelectorAll('.language-btn').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                
                // Get language info
                const lang = e.target.dataset.lang;
                const name = e.target.dataset.name;
                
                // Translate
                translateTexts(lang, name);
            }
        });

        async function translateTexts(targetLanguage, languageName) {
            if (isTranslating) return;
            
            currentLanguage = targetLanguage;
            isTranslating = true;
            
            // Update status
            document.getElementById('testStatus').innerHTML = `
                <div class="loading">üîÑ Translating to ${languageName}...</div>
            `;
            
            // Show loading state for all results
            for (let i = 0; i < testTexts.length; i++) {
                const resultDiv = document.getElementById(`result-${i + 1}`);
                resultDiv.innerHTML = '<div class="loading">Translating...</div>';
            }
            
            try {
                // Translate each text
                for (let i = 0; i < testTexts.length; i++) {
                    const text = testTexts[i];
                    const translation = await translateText(text, targetLanguage, languageName);
                    
                    // Update result
                    const resultDiv = document.getElementById(`result-${i + 1}`);
                    resultDiv.innerHTML = `
                        <div class="translated-text">${translation}</div>
                    `;
                }
                
                // Update status
                document.getElementById('testStatus').innerHTML = `
                    ‚úÖ Successfully translated to ${languageName}
                `;
                
            } catch (error) {
                console.error('Translation error:', error);
                document.getElementById('testStatus').innerHTML = `
                    <div class="error">‚ùå Translation failed: ${error.message}</div>
                `;
            } finally {
                isTranslating = false;
            }
        }

        async function translateText(text, targetLanguage, languageName) {
            if (targetLanguage === 'en') {
                return text;
            }
            
            try {
                const response = await fetch('/api/translate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        text,
                        targetLanguage,
                        languageName
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                
                if (!result.success) {
                    throw new Error(result.message || 'Translation failed');
                }
                
                return result.translatedText;
                
            } catch (error) {
                console.error('Translation API error:', error);
                return `[Error: ${error.message}]`;
            }
        }

        // Initial load message
        document.getElementById('testStatus').innerHTML = `
            üöÄ Translation system ready! Click on a language to test translations.
        `;
    </script>
</body>
</html>